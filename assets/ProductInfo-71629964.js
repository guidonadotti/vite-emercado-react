import{r,l as qe,m as He,k as Ue,f as F,e as ve,j as e,h as We,n as Xe,o as Ye,p as me,t as Ge,A as he,T as Ve,q as Ke,G as Je,L as je,s as O,v as ge,B as K,w as Qe,x as Ze,y as Ce,z as be,a as T,_ as et,C as tt}from"./index-c52a1109.js";import{R as $}from"./Row-886e41f2.js";import{f as nt,m as xe,F as V}from"./Form-ee3cd23b.js";import{m as rt}from"./mayusculas-3fb5da86.js";import{B as st}from"./ButtonGroup-4a8406f6.js";import{C as at}from"./Cards-a0765a8c.js";import{S as it}from"./Spinner-fa1d4b94.js";import{u as ot}from"./useWindowTitle-276ea800.js";import"./CardsPersonalizadas-c2aa28d3.js";function lt(t,n){const a=r.useRef(!0);r.useEffect(()=>{if(a.current){a.current=!1;return}return t()},n)}const J=2**31-1;function Se(t,n,a){const l=a-Date.now();t.current=l<=J?setTimeout(n,l):setTimeout(()=>Se(t,n,a),J)}function ct(){const t=qe(),n=r.useRef();return He(()=>clearTimeout(n.current)),r.useMemo(()=>{const a=()=>clearTimeout(n.current);function l(i,o=0){t()&&(a(),o<=J?n.current=setTimeout(i,o):Se(n,i,Date.now()+o))}return{set:l,clear:a}},[])}const ut=Ue("carousel-caption"),Ne=r.forwardRef(({as:t="div",bsPrefix:n,className:a,...l},i)=>{const o=F(a,ve(n,"carousel-item"));return e.jsx(t,{ref:i,...l,className:o})});Ne.displayName="CarouselItem";const dt=Ne,ft=40;function mt(t){if(!t||!t.style||!t.parentNode||!t.parentNode.style)return!1;const n=getComputedStyle(t);return n.display!=="none"&&n.visibility!=="hidden"&&getComputedStyle(t.parentNode).display!=="none"}const ye=r.forwardRef(({defaultActiveIndex:t=0,...n},a)=>{const{as:l="div",bsPrefix:i,slide:o=!0,fade:u=!1,controls:I=!0,indicators:b=!0,indicatorLabels:S=[],activeIndex:m,onSelect:h,onSlide:v,onSlid:f,interval:N=5e3,keyboard:D=!0,onKeyDown:L,pause:E="hover",onMouseOver:B,onMouseOut:q,wrap:A=!0,touch:Z=!0,onTouchStart:H,onTouchMove:U,onTouchEnd:W,prevIcon:_e=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:ee="Previous",nextIcon:$e=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:te="Next",variant:ne,className:Ie,children:X,...Ee}=We({defaultActiveIndex:t,...n},{activeIndex:"onSelect"}),j=ve(i,"carousel"),w=Xe(),R=r.useRef(null),[re,se]=r.useState("next"),[we,M]=r.useState(!1),[z,ae]=r.useState(!1),[d,Re]=r.useState(m||0);r.useEffect(()=>{!z&&m!==d&&(R.current?se(R.current):se((m||0)>d?"next":"prev"),o&&ae(!0),Re(m||0))},[m,z,d,o]),r.useEffect(()=>{R.current&&(R.current=null)});let y=0,ie;nt(X,(s,c)=>{++y,c===m&&(ie=s.props.interval)});const oe=Ye(ie),x=r.useCallback(s=>{if(z)return;let c=d-1;if(c<0){if(!A)return;c=y-1}R.current="prev",h==null||h(c,s)},[z,d,h,A,y]),p=me(s=>{if(z)return;let c=d+1;if(c>=y){if(!A)return;c=0}R.current="next",h==null||h(c,s)}),Y=r.useRef();r.useImperativeHandle(a,()=>({element:Y.current,prev:x,next:p}));const le=me(()=>{!document.hidden&&mt(Y.current)&&(w?x():p())}),_=re==="next"?"start":"end";lt(()=>{o||(v==null||v(d,_),f==null||f(d,_))},[d]);const ze=`${j}-item-${re}`,Te=`${j}-item-${_}`,Ae=r.useCallback(s=>{Ge(s),v==null||v(d,_)},[v,d,_]),ke=r.useCallback(()=>{ae(!1),f==null||f(d,_)},[f,d,_]),De=r.useCallback(s=>{if(D&&!/input|textarea/i.test(s.target.tagName))switch(s.key){case"ArrowLeft":s.preventDefault(),w?p(s):x(s);return;case"ArrowRight":s.preventDefault(),w?x(s):p(s);return}L==null||L(s)},[D,L,x,p,w]),Me=r.useCallback(s=>{E==="hover"&&M(!0),B==null||B(s)},[E,B]),Pe=r.useCallback(s=>{M(!1),q==null||q(s)},[q]),ce=r.useRef(0),P=r.useRef(0),ue=ct(),Fe=r.useCallback(s=>{ce.current=s.touches[0].clientX,P.current=0,E==="hover"&&M(!0),H==null||H(s)},[E,H]),Oe=r.useCallback(s=>{s.touches&&s.touches.length>1?P.current=0:P.current=s.touches[0].clientX-ce.current,U==null||U(s)},[U]),Le=r.useCallback(s=>{if(Z){const c=P.current;Math.abs(c)>ft&&(c>0?x(s):p(s))}E==="hover"&&ue.set(()=>{M(!1)},N||void 0),W==null||W(s)},[Z,E,x,p,ue,N,W]),de=N!=null&&!we&&!z,G=r.useRef();r.useEffect(()=>{var s,c;if(!de)return;const g=w?x:p;return G.current=window.setInterval(document.visibilityState?le:g,(s=(c=oe.current)!=null?c:N)!=null?s:void 0),()=>{G.current!==null&&clearInterval(G.current)}},[de,x,p,oe,N,le,w]);const fe=r.useMemo(()=>b&&Array.from({length:y},(s,c)=>g=>{h==null||h(c,g)}),[b,y,h]);return e.jsxs(l,{ref:Y,...Ee,onKeyDown:De,onMouseOver:Me,onMouseOut:Pe,onTouchStart:Fe,onTouchMove:Oe,onTouchEnd:Le,className:F(Ie,j,o&&"slide",u&&`${j}-fade`,ne&&`${j}-${ne}`),children:[b&&e.jsx("div",{className:`${j}-indicators`,children:xe(X,(s,c)=>e.jsx("button",{type:"button","data-bs-target":"","aria-label":S!=null&&S.length?S[c]:`Slide ${c+1}`,className:c===d?"active":void 0,onClick:fe?fe[c]:void 0,"aria-current":c===d},c))}),e.jsx("div",{className:`${j}-inner`,children:xe(X,(s,c)=>{const g=c===d;return o?e.jsx(Ve,{in:g,onEnter:g?Ae:void 0,onEntered:g?ke:void 0,addEndListener:Ke,children:(k,Be)=>r.cloneElement(s,{...Be,className:F(s.props.className,g&&k!=="entered"&&ze,(k==="entered"||k==="exiting")&&"active",(k==="entering"||k==="exiting")&&Te)})}):r.cloneElement(s,{className:F(s.props.className,g&&"active")})})}),I&&e.jsxs(e.Fragment,{children:[(A||m!==0)&&e.jsxs(he,{className:`${j}-control-prev`,onClick:x,children:[_e,ee&&e.jsx("span",{className:"visually-hidden",children:ee})]}),(A||m!==y-1)&&e.jsxs(he,{className:`${j}-control-next`,onClick:p,children:[$e,te&&e.jsx("span",{className:"visually-hidden",children:te})]})]})]})});ye.displayName="Carousel";const pe=Object.assign(ye,{Caption:ut,Item:dt});function ht(t){return Je({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"}}]})(t)}function xt(){const{user:t,estaEnCarrito:n,quitarCarrito:a,agregarCarrito:l}=r.useContext(je),{producto:i}=r.useContext(O),{id:o}=ge();function u(){n({email:t,id:o})?a({email:t,id:o}):l({email:t,producto:{id:i.id,name:i.name,count:1,unitCost:i.cost,currency:i.currency,image:i.images[0]}})}return e.jsx(K,{variant:"dark",title:"Agregar al carrito",disabled:t=="",onClick:u,children:n({email:t,id:o})?e.jsx(Qe,{}):e.jsx(Ze,{})})}function pt(){const{producto:{images:t=[],name:n}}=r.useContext(O);return e.jsx(pe,{as:"section",children:t.map(a=>e.jsx(pe.Item,{children:e.jsx("img",{className:"d-block w-100",src:`/${a}`,alt:`Imagen ilustrativa de «${n}»`})},a))})}const Q=r.createContext();function vt({children:t}){const[n,a]=r.useState("");return e.jsx(Q.Provider,{value:{chequeado:n,setChequeado:a},children:t})}function jt({name:t}){const{chequeado:n,setChequeado:a}=r.useContext(Q),l=i=>{a(i.target.value)};return e.jsx(e.Fragment,{children:[...Array(5)].map((i,o)=>{const u=o+1;return e.jsxs("label",{className:"cursor-active",children:[e.jsx("input",{required:!0,className:"btn-check",value:u,type:"radio",name:t,checked:n==u,onChange:l}),n>=u?e.jsx(Ce,{style:{color:"gold"}}):e.jsx(be,{})]},`label_estrella_${o}`)})})}var C={};C.genderForNoun=function(t){var n=t[t.length-1],a=t.slice(-2),l=t.slice(-3);if(a==="ma")return"m";if(l==="ión"||l==="zón"){var i=["corazón","sentención","notición","roción","ansión"];return i.indexOf(t)>-1?"m":"f"}switch(n){case"o":case"e":case"á":case"é":case"í":case"ó":case"ú":{var i=["foto","llave","fe","mano","calle","moto","fiebre","libido","carne","radio","frase","polio","gente","virago","nieve","noche","nube","sangre","suerte","tarde","muerte","madre","base","clase","clave","corriente","fuente","llave","sede","serpiente","torre"];return i.indexOf(t)>-1?"f":"m"}}switch(n){case"a":{var i=["panda","buda","día","planeta","mapa","estratega"];return i.indexOf(t)>-1?"m":"f"}case"d":{var i=["huésped","ataúd","abad","alud","áspid","laúd","récord","milord","césped"];return i.indexOf(t)>-1?"m":"f"}case"z":{var i=["aprendiz","cáliz","arroz","pez","lápiz","ajedrez","antifaz","maíz","albornoz","avestruz","altavoz","altramuz","arroz","barniz","cariz","disfraz","haz","matiz"];return i.indexOf(t)>-1?"m":"f"}}var i=["miel","sal","hiel","piel","coliflor","sor","labor","flor"];return i.indexOf(t)>-1?"f":"m"};C.isMasculine=function(t){return this.genderForNoun(t)==="m"};C.isFeminine=function(t){return this.genderForNoun(t)==="f"};C.indefiniteArticle=function(t,n){return n===void 0||n===1?this.isFeminine(t)?"una":"un":this.isFeminine(t)?"unas":"unos"};C.addIndefiniteArticle=function(t,n){return this.indefiniteArticle(t,n)+" "+t};C.definiteArticle=function(t,n){return n===void 0||n===1?this.isFeminine(t)?"la":"el":this.isFeminine(t)?"las":"los"};C.addDefiniteArticle=function(t,n){return this.definiteArticle(t,n)+" "+t};function gt(t){const n=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${n}-${a}-${l} ${i}:${o}:${u}`}function Ct(){const{id:t}=ge(),[n,a]=r.useState(""),{chequeado:l,setChequeado:i}=r.useContext(Q),{producto:{name:o="producto"},setComentariosUsuario:u}=r.useContext(O),{user:I,getActiveUsername:b}=r.useContext(je),S=r.useRef(),m=f=>{a(f.target.value),f.target.style.height="auto",f.target.style.height=f.target.scrollHeight+"px"};function h(f){if(f.preventDefault(),!I){alert("Tiene que estar logueado para comentar");return}const N={product:parseInt(t),score:parseInt(l),description:n.trim(),user:b({email:I}),dateTime:gt(new Date)};u(D=>[...D,N]),a(""),i("")}const v=rt(C.definiteArticle(o.split(" ")[0]));return e.jsxs(V,{ref:S,noValidate:!0,onSubmit:h,children:[e.jsx($,{children:e.jsx(T,{md:"8",children:e.jsx(V.Group,{className:"mb-3",children:e.jsx(V.Control,{as:"textarea",placeholder:`${v} ${o} me pareció...`,required:!0,rows:2,value:n,onChange:m,style:{resize:"none",overflow:"hidden"},name:"comentario"})})})}),e.jsx($,{children:e.jsx(T,{md:"8",children:e.jsx(jt,{name:"estrellas"})})}),e.jsxs(st,{children:[e.jsx(K,{disabled:l==""||n.trim()=="",type:"submit",children:"Enviar"}),e.jsx(K,{disabled:l==""&&n=="",onClick:()=>{a(""),i("")},variant:"ligth",children:"Cancelar"})]})]})}function bt({dateTime:t,description:n,score:a,user:l,...i}){return e.jsxs($,{as:"article",...i,children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("h4",{children:e.jsxs("b",{children:["@",l]})}),e.jsx("span",{className:"text-muted number",children:t})]}),e.jsx("p",{className:"my-2",children:n}),e.jsxs("span",{children:[[...Array(a)].map((o,u)=>e.jsx(Ce,{style:{color:"gold"}},`${l}_${t}_estrella_llena_${u}`)),[...Array(5-a)].map((o,u)=>e.jsx(be,{},`${l}_${t}_estrella_vacia_${u}`))]})]})}const St=r.lazy(()=>et(()=>import("./Error-d44d9e26.js"),["assets/Error-d44d9e26.js","assets/index-c52a1109.js","assets/index-1793a3e6.css","assets/useWindowTitle-276ea800.js","assets/Error-57662c42.css"]));function Nt({datos:t}){return t.length==0?e.jsx("h2",{className:"my-3",children:"¡Sé el primero en comentar!"}):e.jsx($,{as:"section",className:"mt-4 justify-content-between g-4",children:e.jsx(T,{md:"8",children:t.map((n,a)=>e.jsx(bt,{className:"mt-2 border-bottom",...n},`${n.product}_${a}`))})})}function At(){const{producto:t,isLoadingProducto:n,errorProducto:a,comentarios:l,comentariosUsuario:i}=r.useContext(O),{name:o,currency:u,cost:I,soldCount:b,description:S,relatedProducts:m=[]}=t;return ot({windowTitle:o}),n?e.jsx(it,{}):a?e.jsx(St,{children:e.jsx("h2",{children:"Producto no encontrado"})}):e.jsxs(tt,{as:"main",className:"p-3",children:[e.jsx("h1",{children:e.jsx("b",{children:o})}),e.jsx("hr",{}),e.jsxs($,{className:"gy-3 mb-2",children:[e.jsx(T,{lg:"4",as:"section",children:e.jsx(pt,{})}),e.jsxs(T,{as:"section",children:[e.jsx("h2",{children:e.jsxs("b",{children:[u," ",I]})}),e.jsxs("p",{children:[b," unidades vendidas"]}),e.jsx("h2",{children:"Descripción"}),e.jsx("p",{children:S}),e.jsx(xt,{})]})]}),e.jsxs($,{as:"section",children:[e.jsxs("h2",{children:[e.jsx(ht,{})," Opiniones"]}),e.jsx(vt,{children:e.jsx(Ct,{})})]}),e.jsx(Nt,{datos:l.concat(i)}),e.jsx("h2",{className:"mt-2",children:"Productos relacionados"}),e.jsx($,{className:"g-2",children:m.map(({name:h,image:v,id:f})=>e.jsx(T,{xs:"6",md:"3",children:e.jsx(at,{to:`/producto/${f}`,name:h,imgSrc:`/${v}`})},`Producto_${f}`))})]})}export{At as default};
