import{r as k,M as ie,j as f,L as Ye,C as kn,B as qn}from"./index-c52a1109.js";import{F as J}from"./Form-ee3cd23b.js";import{R as Cn}from"./Row-886e41f2.js";import{S as Hn}from"./Spinner-fa1d4b94.js";import{u as Ln}from"./useWindowTitle-276ea800.js";import{I as q}from"./Input-86f7d3ee.js";var Ze={exports:{}},He={exports:{}},Qe;function Vn(){return Qe||(Qe=1,function(S){S.exports=function(){var x={"./src/index.ts":function(l,d,P){P.r(d),P.d(d,{beginMultipartUpload:function(){return ye},completeUploadPart:function(){return de},getUploadPart:function(){return me},request:function(){return C}});function D(a,i,h){return h?i?i(a):a:((!a||!a.then)&&(a=Promise.resolve(a)),i?a.then(i):a)}function N(a){return function(){for(var i=[],h=0;h<arguments.length;h++)i[h]=arguments[h];try{return Promise.resolve(a.apply(this,i))}catch(g){return Promise.reject(g)}}}var C=N(function(a,i){var h=he(a,i);return D(W(a,i,h),function(g){var p=re(g),_=ce(g,i.responseHeader);return{url:h,ok:g.status>=200&&g.status<300,status:g.status,statusText:g.statusText,body:_||p}})}),W=N(function(a,i,h){var g=new XMLHttpRequest;return g.open(i.method,h,!0),g.withCredentials=a.WITH_CREDENTIALS,D(ee(a,i),function(p){return p.forEach(function(_,V){g.setRequestHeader(V,_)}),new Promise(function(_){g.onreadystatechange=function(){g.readyState===XMLHttpRequest.DONE&&_(g)},g.send($(i))})})}),ee=N(function(a,i){return D(te(i,a.USERNAME),function(h){return D(te(i,a.PASSWORD),function(g){return D(te(i,a.HEADERS),function(p){var _=new Headers(Object.assign(Object.assign({Accept:z},p),i.headers));if(ne(h)&&ne(g)){var V=btoa("".concat(h,":").concat(g));_.append("Authorization","Basic ".concat(V))}return i.body&&_.append(A,z),_})})})}),te=N(function(a,i){return typeof i=="function"?i(a):i}),A="Content-Type",z="application/json";function L(a){return a!=null}function ne(a){return typeof a=="string"&&a!==""}function ue(a){var i=[];return Object.keys(a).forEach(function(h){var g=a[h];L(g)&&(Array.isArray(g)?g.forEach(function(p){i.push("".concat(encodeURIComponent(h),"=").concat(encodeURIComponent(String(p))))}):i.push("".concat(encodeURIComponent(h),"=").concat(encodeURIComponent(String(g)))))}),i.length>0?"?".concat(i.join("&")):""}function he(a,i){var h=i.path.replace(/[:]/g,"_"),g="".concat(a.BASE).concat(h);return i.query?"".concat(g).concat(ue(i.query)):g}function $(a){if(a.body)return JSON.stringify(a.body)}function ce(a,i){return i?a.getResponseHeader(i):null}function re(a){var i=a.getResponseHeader(A);if(i){var h=i.toLowerCase().startsWith(z);return h?JSON.parse(a.responseText):a.responseText}return null}function Q(a){return function(){for(var i=[],h=0;h<arguments.length;h++)i[h]=arguments[h];try{return Promise.resolve(a.apply(this,i))}catch(g){return Promise.reject(g)}}}var me=Q(function(a,i,h,g){return C(a,{method:"GET",path:"".concat(se).concat(i).concat(fe,"/").concat(h).concat(le).concat(g)})}),de=Q(function(a,i,h,g,p){return C(a,{method:"PUT",path:"".concat(se).concat(i).concat(fe,"/").concat(h).concat(le).concat(g),body:p})}),ye=Q(function(a,i,h){return C(a,{method:"POST",path:"".concat(se).concat(i).concat(fe),body:h})}),se="/v2/accounts/",fe="/uploads",le="/parts/"}},v={};function b(l){if(v[l])return v[l].exports;var d=v[l]={exports:{}};return x[l](d,d.exports,b),d.exports}return function(){b.d=function(l,d){for(var P in d)b.o(d,P)&&!b.o(l,P)&&Object.defineProperty(l,P,{enumerable:!0,get:d[P]})}}(),function(){b.o=function(l,d){return Object.prototype.hasOwnProperty.call(l,d)}}(),function(){b.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})}}(),b("./src/index.ts")}()}(He)),He.exports}var Le={exports:{}},Xe;function Bn(){return Xe||(Xe=1,function(S){S.exports=function(){var x={"./src/index.ts":function(l,d,P){P.r(d),P.d(d,{ProgressSmoother:function(){return D}});function D(N){var C,W,ee=1e3,te=.33,A=(C=N.minDelayUntilFirstValue)!==null&&C!==void 0?C:0,z=(W=N.teardownTime)!==null&&W!==void 0?W:0,L=N.valueIncreaseRatePerSecond,ne=N.averageTimeBetweenValues,ue=N.maxValue,he=N.valueIncreaseDelta,$,ce=Date.now(),re=0,Q=0;function me(p){var _=p();return _>re&&(re=_),re}function de(p){return p.value===ue}function ye(p,_){if(de(p)){var V=Math.max(ee,z),oe=_-p.time,pe=oe/V,ge=Math.min(1,pe),be=a(ge),Ee=p.value-Q;return Q+Ee*be}return le(p.value,_,ce)}function se(p){var _=Math.min(he,ue*te),V=_/L*1e3,oe=A+V,pe=p-ce,ge=pe/oe,be=Math.min(1,ge);return be*_}function fe(p,_){var V=3.5;return 1-Math.exp(-(p-_)/(ne*V))}function le(p,_,V){var oe=fe(_,V);return oe*p+(1-oe)*Q}function a(p){return p*p}function i(p,_){if($!==void 0){if(de($))return;Q=le($.value,$.time,ce),ce=$.time}$={time:_??Date.now(),value:Math.min(p,ue)}}function h(p){return me(function(){var _=p??Date.now();return $!==void 0?ye($,_):se(_)})}function g(p){return h(p)/ue}return{setValue:i,smoothedValue:h,smoothedFactor:g}}}},v={};function b(l){if(v[l])return v[l].exports;var d=v[l]={exports:{}};return x[l](d,d.exports,b),d.exports}return function(){b.d=function(l,d){for(var P in d)b.o(d,P)&&!b.o(l,P)&&Object.defineProperty(l,P,{enumerable:!0,get:d[P]})}}(),function(){b.o=function(l,d){return Object.prototype.hasOwnProperty.call(l,d)}}(),function(){b.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})}}(),b("./src/index.ts")}()}(Le)),Le.exports}(function(S){S.exports=function(){var x={"./src/index.ts":function(l,d,P){P.r(d),P.d(d,{Upload:function(){return dn},UploadApiError:function(){return V}});var D=Vn();function N(e,n,t){if(t)return n?n(e()):e();try{var r=Promise.resolve(e());return n?r.then(n):r}catch(s){return Promise.reject(s)}}function C(e,n){if(e)throw n;return n}function W(e,n){try{var t=e()}catch(r){return n(!0,r)}return t&&t.then?t.then(n.bind(null,!1),n.bind(null,!0)):n(!1,t)}function ee(){}function te(e,n){if(!n)return e&&e.then?e.then(ee):Promise.resolve()}function A(e,n,t){if(!e.s){if(t instanceof z)if(t.s)n&1&&(n=t.s),t=t.v;else{t.o=A.bind(null,e,n);return}if(t&&t.then){t.then(A.bind(null,e,n),A.bind(null,e,2));return}e.s=n,e.v=t;var r=e.o;r&&r(e)}}var z=function(){function e(){}return e.prototype.then=function(n,t){var r=new e,s=this.s;if(s){var m=s&1?n:t;if(m){try{A(r,1,m(this.v))}catch(E){A(r,2,E)}return r}else return this}return this.o=function(E){try{var O=E.v;E.s&1?A(r,1,n?n(O):O):t?A(r,1,t(O)):A(r,2,O)}catch(F){A(r,2,F)}},r},e}();function L(e){return e instanceof z&&e.s&1}function ne(e,n,t){for(var r;;){var s=e();if(L(s)&&(s=s.v),!s)return m;if(s.then){r=0;break}var m=t();if(m&&m.then)if(L(m))m=m.s;else{r=1;break}if(n){var E=n();if(E&&E.then&&!L(E)){r=2;break}}}var O=new z,F=A.bind(null,O,2);return(r===0?s.then(H):r===1?m.then(X):E.then(_e)).then(void 0,F),O;function X(we){m=we;do{if(n&&(E=n(),E&&E.then&&!L(E))){E.then(_e).then(void 0,F);return}if(s=e(),!s||L(s)&&!s.v){A(O,1,m);return}if(s.then){s.then(H).then(void 0,F);return}m=t(),L(m)&&(m=m.v)}while(!m||!m.then);m.then(X).then(void 0,F)}function H(we){we?(m=t(),m&&m.then?m.then(X).then(void 0,F):X(m)):A(O,1,m)}function _e(){(s=e())?s.then?s.then(H).then(void 0,F):H(s):A(O,1,m)}}function ue(e,n){return e&&e.then?e.then(n):n(e)}function he(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{return Promise.resolve(e.apply(this,n))}catch(r){return Promise.reject(r)}}}function $(){var e,n,t=function(E){return N(r,function(){return W(E,function(O,F){return s(),C(O,F)})})},r=he(function(){return ue(ne(function(){return e!==void 0},void 0,function(){return te(e)}),function(){e=new Promise(function(m){n=m})})}),s=function(){if(n===void 0)throw new Error("Unable to release mutex: already released.");n(),n=void 0,e=void 0};return{safe:t}}var ce=Bn();function re(e){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},re(e)}function Q(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,n,t){return n&&Q(e.prototype,n),t&&Q(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function de(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ye(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&p(e,n)}function se(e){var n=h();return function(){var r=_(e),s;if(n){var m=_(this).constructor;s=Reflect.construct(r,arguments,m)}else s=r.apply(this,arguments);return fe(this,s)}}function fe(e,n){if(n&&(re(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return le(e)}function le(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){var n=typeof Map=="function"?new Map:void 0;return a=function(r){if(r===null||!g(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(r))return n.get(r);n.set(r,s)}function s(){return i(r,arguments,_(this).constructor)}return s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),p(s,r)},a(e)}function i(e,n,t){return h()?i=Reflect.construct:i=function(s,m,E){var O=[null];O.push.apply(O,m);var F=Function.bind.apply(s,O),X=new F;return E&&p(X,E.prototype),X},i.apply(null,arguments)}function h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function p(e,n){return p=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},p(e,n)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(e)}var V=function(e){ye(t,e);var n=se(t);function t(r){var s;return de(this,t),s=n.call(this,r.error.message),s.errorCode=r.error.code,s.details=r.error.details,s}return me(t)}(a(Error));function oe(e,n){if(e)throw n;return n}function pe(e,n){try{var t=e()}catch(r){return n(!0,r)}return t&&t.then?t.then(n.bind(null,!1),n.bind(null,!0)):n(!1,t)}function ge(e){if(e&&e.then)return e.then(Se)}function be(e){return tn(e)||nn(e)||en(e)||Ee()}function Ee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function en(e,n){if(e){if(typeof e=="string")return Re(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Re(e,n)}}function nn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tn(e){if(Array.isArray(e))return Re(e)}function Re(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Se(){}var Ve=7;function ae(e,n){if(!n)return e&&e.then?e.then(Se):Promise.resolve()}var rn="W142hJk";function T(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{return Promise.resolve(e.apply(this,n))}catch(r){return Promise.reject(r)}}}var on=["free","demo"];function M(e,n,t){return t?n?n(e):e:((!e||!e.then)&&(e=Promise.resolve(e)),n?e.then(n):e)}var Ue="public_";function je(e,n,t){if(t)return n?n(e()):e();try{var r=Promise.resolve(e());return n?r.then(n):r}catch(s){return Promise.reject(s)}}var an=5;function Oe(e,n){return je(e,Se,n)}var un=20;function Be(e,n){try{var t=e()}catch(r){return n(r)}return t&&t.then?t.then(void 0,n):t}var cn=100;function We(e){var n=e();if(n&&n.then)return n.then(Se)}var sn=5,Ie=10,fn=2147483,ln="/api/v1/access_tokens/",B="[upload-js] ";function dn(e){var n,t,r,s,m,E,O,F,X,H,_e=$(),we=(t=(n=e.internal)===null||n===void 0?void 0:n.apiUrl)!==null&&t!==void 0?t:"https://api.bytescale.com",Ke=(s=(r=e.internal)===null||r===void 0?void 0:r.cdnUrl)!==null&&s!==void 0?s:"https://upcdn.io",pn=(E=(m=e.internal)===null||m===void 0?void 0:m.authenticateWithApiKey)!==null&&E!==void 0?E:!0,Te=(O=e.internal)===null||O===void 0?void 0:O.headers,vn=e.debug===!0,Me=" was called.",K;if((e??void 0)===void 0)throw new Error("".concat(B,"Config parameter required."));if(e.debug===!0&&console.log("".concat(B,"Initialized with API key '").concat(e.apiKey,"'")),((F=e.apiKey)!==null&&F!==void 0?F:void 0)===void 0)throw new Error("".concat(B,"Please provide an API key via the 'apiKey' config parameter."));if(e.apiKey.trim()!==e.apiKey)throw new Error("".concat(B,"API key needs trimming (whitespace detected)."));if(((X=e.internal)===null||X===void 0?void 0:X.authenticateWithApiKey)===!1)H=e.internal.accountId;else if(on.includes(e.apiKey))H=rn;else{if(!e.apiKey.startsWith(Ue))throw new Error("".concat(B,'API key must begin with "').concat(Ue,'".'));if(H=e.apiKey.substr(Ue.length,Ve),H.length!==Ve)throw new Error("".concat(B,"API key is too short!"))}var Je="".concat(Ke).concat(ln).concat(H),hn=T(function(c,o){return ae($e(T(function(u){return u.beginAuthSession(c,o)}),T(function(){if(Y("'beginAuthSession'".concat(Me)),(K==null?void 0:K.authUrl)===c){ke("'beginAuthSession' already called. Ignoring this call. Hint: call 'endAuthSession' and then 'beginAuthSession' if you want to restart the auth session.");return}return je(ze,function(){var u={accessToken:void 0,accessTokenRefreshHandle:void 0,isActive:!0,authUrl:c};return K=u,ae(De(c,o,u))})})))}),mn=T(function(){return ae($e(T(function(c){return c.endAuthSession()}),T(function(){return Y("'endAuthSession'".concat(Me)),Oe(ze)})))}),yn=T(function(c){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Y("'uploadFile'".concat(Me));var u=[],w=function(I){u.push(I)},y=function(){return u.forEach(function(I){return I()})};return o.onBegin!==void 0&&o.onBegin({cancel:y}),Be(function(){return M(bn(c,o,w))},function(j){throw y(),j})}),gn=function(o,u){var w,y="raw",j=typeof u=="string"?{transformation:u}:u;return"".concat(Ke,"/").concat(H,"/").concat((w=j==null?void 0:j.transformation)!==null&&w!==void 0?w:y).concat(o).concat((j==null?void 0:j.auth)===!0?"?_auth=true":"")},Ae={beginAuthSession:hn,endAuthSession:mn,uploadFile:yn,url:gn},ze=T(function(){return ae(_e.safe(T(function(){if(K!==void 0){var c=K;return K=void 0,c.accessTokenRefreshHandle!==void 0&&clearTimeout(c.accessTokenRefreshHandle),c.isActive=!1,Oe(Pn)}})))}),bn=T(function(c,o,u){var w=(0,ce.ProgressSmoother)({maxValue:c.size,teardownTime:1e3,minDelayUntilFirstValue:2e3,valueIncreaseDelta:204800,valueIncreaseRatePerSecond:51200,averageTimeBetweenValues:1e3}),y=function(I){if(o.onProgress===void 0)I();else{var R=w.smoothedValue(),U=c.size;R===U&&I(),o.onProgress({bytesSent:R,bytesTotal:U,progress:Math.round(R/U*100)})}};return xn(cn,y,T(function(){var j={path:o.path,metadata:o.metadata,mime:En(c.type),originalFileName:c.name,protocol:"1.1",size:c.size,tags:o.tags};return Y("Initiating file upload. Params = ".concat(JSON.stringify(j))),M((0,D.beginMultipartUpload)(Fe(),H,j),function(I){var R=xe(I);Y("Initiated file upload. Metadata = ".concat(JSON.stringify(R)));var U=function(){var G=0;return function(){if(G!==R.uploadParts.count-1)return++G}}(),qe=[R.uploadParts.first],Un=T(function(G){var Z=qe.pop();if(Z!==void 0)return Y("Dequeued part ".concat(Z.uploadPartIndex,"."),G),Z;var ve=U();if(ve===void 0){Y("No parts remaining.",G);return}return Y("Fetching metadata for part ".concat(ve,"."),G),M((0,D.getUploadPart)(Fe(),H,R.uploadId,ve),xe)}),Pe=[],On=function G(Z){return M(Un(Z),function(ve){return We(function(){if(ve!==void 0){var Ge=0,In=function(Mn){var Ce=Mn.bytesSent;Pe[Z]===void 0?Pe[Z]=Ce:(Pe[Z]-=Ge,Pe[Z]+=Ce),Ge=Ce;var Dn=Pe.reduce(function(Nn,Fn){return Nn+Fn});w.setValue(Dn)};return M(wn(c,ve,In,u,Z),function(){return ae(G(Z))})}})})};return M(Promise.all(be(Array(an).keys()).map(function(G){return M(On(G))})),function(){var G=Object.assign({accountId:H,file:c},R.file);return Y("File upload completed."),G})})}))}),_n=T(function(c,o,u,w){var y=new XMLHttpRequest,j=!0;return w(function(){j&&y.abort()}),pe(function(){return M(new Promise(function(I,R){y.upload.addEventListener("progress",function(U){U.lengthComputable&&u({bytesSent:U.loaded,bytesTotal:U.total})},!1),y.addEventListener("load",function(){if(u({bytesSent:o.size,bytesTotal:o.size}),Math.floor(y.status/100)===2){var U=y.getResponseHeader("etag");U==null?R(new Error("File upload error: no etag header in upload response.")):I({etag:U})}else R(new Error("File upload error: status code ".concat(y.status)))}),y.onabort=function(){return R(new Error("File upload cancelled."))},y.onerror=function(){return R(new Error("File upload error."))},y.ontimeout=function(){return R(new Error("File upload timeout."))},y.open("PUT",c),y.send(o)}))},function(I,R){return j=!1,oe(I,R)})}),wn=T(function(c,o,u,w,y){var j=o.range.inclusiveEnd===-1?new Blob:c.slice(o.range.inclusiveStart,o.range.inclusiveEnd+1);return Y("Uploading part ".concat(o.uploadPartIndex,"."),y),M(_n(o.uploadUrl,j,u,w),function(I){var R=I.etag;return M((0,D.completeUploadPart)(Fe(),H,o.uploadId,o.uploadPartIndex,{etag:R}),function(U){xe(U),Y("Uploaded part ".concat(o.uploadPartIndex,"."),y)})})}),xn=T(function(c,o,u){var w,y=new Promise(function(U){w=U}),j=!0,I=function(){j&&(w(),clearInterval(R),j=!1)},R=setInterval(function(){return o(I)},c);return pe(function(){return je(u,function(U){return M(y,function(){return U})})},function(U,qe){return I(),oe(U,qe)})}),Pn=T(function(){return ae(An(Je,{},!0))}),$e=T(function(c,o){var u=Sn();return We(function(){return u!==Ae?ae(c(u)):Oe(o)})}),Sn=function(){var o="uploadJsAuthInstance",u=window[o];return u===void 0&&(u=Ae,window[o]=Ae),u},De=T(function(c,o,u){return ge(Be(function(){return ae(_e.safe(T(function(){if(u.isActive)return je(o,function(w){return M(Tn(c,w),function(y){return M(jn(Je,{},{accessToken:y},!0),function(j){var I=j.ttlSeconds-un;I<Ie&&Rn("JWT expiration is too short: waiting for ".concat(Ie," seconds before refreshing.")),u.accessToken=j.accessToken,u.accessTokenRefreshHandle=window.setTimeout(function(){De(c,o,u).then(function(){},function(R){return ke("Permanent error when refreshing access token: ".concat(R))})},Math.min(fn,Math.max(Ie,I))*1e3)})})})})))},function(w){return ke("Error when refreshing access token: ".concat(w)),M(new Promise(function(y){return setTimeout(y,sn*1e3)}),function(){return ae(De(c,o,u))})}))}),jn=T(function(c,o,u,w){return M(Ne({method:"PUT",path:c,headers:o,body:u},w),function(y){return M(xe(y))})}),Tn=T(function(c,o){var u="Your auth API endpoint";return M(Ne({method:"GET",path:c,headers:o},!1),function(w){if(!w.ok)throw new Error("".concat(B).concat(u," returned a failed response. Please ensure the endpoint's status code is 200."));var y=w.body;if(typeof y!="string")throw new Error("".concat(B).concat(u," returned an unsupported response. Please ensure: 1) 'Content-Type: text/plain' is in the HTTP response headers 2) the status code is 200."));if(y.length===0)throw new Error("".concat(B).concat(u," returned an empty string. Please return a valid JWT instead."));if(y.trim().length!==y.length)throw new Error("".concat(B).concat(u," returned whitespace around the JWT, please remove it."));return y})}),An=T(function(c,o,u){return M(Ne({method:"DELETE",path:c,headers:o},u),function(w){xe(w)})}),xe=function(o){var u;if(o.ok)return o.body;var w=o.body;throw typeof((u=w==null?void 0:w.error)===null||u===void 0?void 0:u.code)=="string"?new V(w):new Error("".concat(B,"Network error. If problem persists, and your network connectivity is healthy, please contact support@bytescale.com and provide: (a) time of failed request in UTC (b) screenshot of failed network response body (c) screenshot of failed network response header (d) browser + version."))},Ne=T(function(c,o){return(0,D.request)({BASE:c.path,WITH_CREDENTIALS:o},Object.assign(Object.assign({},c),{path:""}))}),Fe=function(){var o={BASE:we,WITH_CREDENTIALS:!0};pn&&(o.USERNAME="apikey",o.PASSWORD=e.apiKey);var u=K==null?void 0:K.accessToken;return(Te!==void 0||u!==void 0)&&(o.HEADERS=T(function(){return M(Te===void 0?{}:Te(),function(w){var y=K==null?void 0:K.accessToken;return Object.assign(Object.assign({},w),y===void 0?{}:{"authorization-token":y})},Te===void 0)})),o},En=function(o){var u=o.toLowerCase(),w=/^[a-z0-9]+\/[a-z0-9+\-._]+(?:;[^=]+=[^;]+)*$/;return w.test(u)?u:void 0},Y=function(o,u){vn&&console.log("".concat(B).concat(o).concat(u!==void 0?" (Worker ".concat(u,")"):""))},ke=function(o){console.error("".concat(B).concat(o))},Rn=function(o){console.warn("".concat(B).concat(o))};return Ae}}},v={};function b(l){if(v[l])return v[l].exports;var d=v[l]={exports:{}};return x[l](d,d.exports,b),d.exports}return function(){b.d=function(l,d){for(var P in d)b.o(d,P)&&!b.o(l,P)&&Object.defineProperty(l,P,{enumerable:!0,get:d[P]})}}(),function(){b.o=function(l,d){return Object.prototype.hasOwnProperty.call(l,d)}}(),function(){b.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})}}(),b("./src/index.ts")}()})(Ze);var Wn=Ze.exports;function Kn(){const{userData:S,colProps:x}=k.useContext(ie),v="primer_nombre";return f.jsxs(q,{name:v,...x,children:[f.jsx(J.Label,{className:"required",children:"Primer Nombre"}),f.jsx(q.Control,{required:!0,type:"text",defaultValue:S[v]}),f.jsx(J.Control.Feedback,{type:"invalid",children:"Debe ingresar su primer nombre"})]})}function Jn(){const{userData:S,colProps:x}=k.useContext(ie),v="segundo_nombre";return f.jsxs(q,{name:v,...x,children:[f.jsx(J.Label,{children:"Segundo Nombre"}),f.jsx(q.Control,{type:"text",defaultValue:S[v]})]})}function zn(){const{userData:S,colProps:x}=k.useContext(ie),v="primer_apellido";return f.jsxs(q,{name:v,...x,children:[f.jsx(J.Label,{className:"required",children:"Primer Apellido"}),f.jsx(q.Control,{required:!0,type:"text",defaultValue:S[v]}),f.jsx(J.Control.Feedback,{type:"invalid",children:"Debe ingresar su primer apellido"})]})}function $n(){const{userData:S,colProps:x}=k.useContext(ie),v="segundo_apellido";return f.jsxs(q,{name:v,...x,children:[f.jsx(J.Label,{children:"Segundo Apellido"}),f.jsx(q.Control,{type:"text",defaultValue:S[v]})]})}function Gn(){const{userData:S,colProps:x}=k.useContext(ie),{users:v,user:b}=k.useContext(Ye),l=Object.keys(v).filter(W=>W!==b),d="email",P=k.useRef(),[D,N]=k.useState("");k.useEffect(()=>{P.current.setCustomValidity(D)},[D]);function C(W){const{value:ee}=W.target;N(()=>l.includes(ee)?"Este mail ya está en uso.":"")}return f.jsxs(q,{name:d,...x,children:[f.jsx(J.Label,{className:"required",children:"E-mail"}),f.jsx(q.Control,{ref:P,onChange:C,required:!0,type:"email",defaultValue:S[d]}),f.jsx(J.Control.Feedback,{type:"invalid",children:D||"Debe ingresar un email válido"})]})}function Qn(){const{userData:S,colProps:x}=k.useContext(ie),v="telefono";return f.jsxs(q,{name:v,...x,children:[f.jsx(J.Label,{children:"Teléfono de contacto"}),f.jsx(q.Control,{type:"text",defaultValue:S[v]})]})}function Xn(){const{colProps:S,imgInput:x,names:v}=k.useContext(ie),{imgPerfilName:b}=v;return f.jsxs(q,{name:b,...S,children:[f.jsx(J.Label,{children:"Foto de perfil"}),f.jsx(q.Control,{accept:"image/*",type:"file",ref:x})]})}function Yn(){const{userData:S,colProps:x,names:v}=k.useContext(ie),{nombreDeUsuarioName:b}=v;return f.jsxs(q,{name:b,...x,children:[f.jsx(J.Label,{className:"required",children:"Nombre de usuario"}),f.jsx(q.Control,{type:"text",required:!0,pattern:"\\w{3,16}",defaultValue:S[b]}),f.jsx(J.Control.Feedback,{type:"invalid",children:"Debe ingresar un nombre de usuario válido."})]})}const Zn=Wn.Upload({apiKey:"free"});function et(S){const x={};return S.forEach((v,b)=>{v instanceof File?v.size>0&&(x[b]=v):v!==""&&(x[b]=v)}),x}function ct(){Ln({windowTitle:"Mi perfil"});const{user:S,getUserData:x,setUserData:v}=k.useContext(Ye),{imgInput:b,names:l}=k.useContext(ie),{imgPerfilName:d,nombreDeUsuarioName:P}=l,D=x({email:S,data:P}),[N,C]=k.useState(!1),[W,ee]=k.useState(!1);async function te(A){A.preventDefault();const z=A.currentTarget;if(!z.checkValidity()){C(!0);return}C(!1);const L=et(new FormData(z));if(b.current.files.length>0)try{const{fileUrl:ne}=await Zn.uploadFile(b.current.files[0],{onProgress:()=>ee(!0)});L[d]=ne}catch(ne){alert(`Error!
${ne.message}`),L[d]=""}ee(!1),v({email:S,data:L})}return f.jsxs(kn,{as:"main",className:"my-3",children:[W&&f.jsx(Hn,{}),f.jsxs("section",{className:"d-flex justify-content-between ",children:[f.jsx("h1",{children:"Mi Perfil"}),f.jsx("img",{onError:A=>A.target.src="img/img_perfil.png",src:x({email:S,data:d}),className:"img-perfil align-self-center",alt:`Imagen de perfil de ${D}`})]}),f.jsx("hr",{}),f.jsxs(J,{noValidate:!0,validated:N,onSubmit:te,children:[f.jsxs(Cn,{as:"section",className:"gy-3",children:[f.jsx(Kn,{}),f.jsx(Jn,{}),f.jsx(zn,{}),f.jsx($n,{}),f.jsx(Gn,{}),f.jsx(Qn,{}),f.jsx(Xn,{}),f.jsx(Yn,{})]}),f.jsx("hr",{}),f.jsx(qn,{type:"submit",children:"Guardar cambios"})]})]})}export{ct as default};
